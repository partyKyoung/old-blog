{"componentChunkName":"component---src-templates-blog-template-tsx","path":"/2018-07-03-javascript-issue-ex-if/","webpackCompilationHash":"0b19d7a726d158ee4bf0","result":{"data":{"site":{"siteMetadata":{"title":"Kyoungah's dev blog.","author":"Kyoungah"}},"markdownRemark":{"id":"fcbe51ef-c73b-5614-92f8-ff6e91b43c6a","excerpt":"…","html":"<p>회사에서 열심히 일을 하던 도중 이슈가 하나 생겼다. 폰으로 사진 파일을 업로드 하면 어떤 사진들은 이미지 방향이 자꾸 돌아가서 업로드 되는 것이었다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1b67f28f09b6660943c4efef9631f004/f2cb1/javascript-memo-exif-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 140.64171122994654%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"이렇게 이미지 뷰어나 앨범에서 보면 제대로 출력되는 사진들이\"\n        title=\"이렇게 이미지 뷰어나 앨범에서 보면 제대로 출력되는 사진들이\"\n        src=\"/static/1b67f28f09b6660943c4efef9631f004/b9e4f/javascript-memo-exif-1.png\"\n        srcset=\"/static/1b67f28f09b6660943c4efef9631f004/cf440/javascript-memo-exif-1.png 148w,\n/static/1b67f28f09b6660943c4efef9631f004/d2d38/javascript-memo-exif-1.png 295w,\n/static/1b67f28f09b6660943c4efef9631f004/b9e4f/javascript-memo-exif-1.png 590w,\n/static/1b67f28f09b6660943c4efef9631f004/f9b6a/javascript-memo-exif-1.png 885w,\n/static/1b67f28f09b6660943c4efef9631f004/f2cb1/javascript-memo-exif-1.png 1122w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">이렇게 이미지 뷰어나 앨범에서 보면 제대로 출력되는 사진들이</figcaption>\n  </figure>\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/625719c62fa92f2a941b08f9a8efa550/e198c/javascript-memo-exif-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.75550122249389%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFWElEQVQ4yx2S22/T5x3G/Q/sZtIGIrgBJz47Pp+PsWM7cXyKEwfbcRK7ieNDbCCkYHOMoEs4pKMtUErbgIooZWszgZRKtN1WpXQwNFZNsKldp5ZWqtpO683Uq2q7+ewdF+/FV7/3fX7P9/M8kn2H2wQTQwxm0uIkSU9kyJazTNazLF+psfjcJFN7R8lV0swu5ni6nafQypFvjZMqpRjOpxidHiddSHBs+QiSaCbOT7p+zs9kUn761Fa2KrroUkuxxZRMHXQRKWgJ7tKhcEhR2Ldhi8jxjvWhDsuRWqVsUXYhs/TSpdpKaa6AZGQyxxbFDnb0qejWKenWyjEGtChscvyjeuHGQ6xoprjPQ2Tcgt6pxjViwhzX0etQoBCz1qdBI95VazNIUkJwm1qGzKBBqlWyU69A41KiEpd7LT0o3b04kkqCWR3RggWz+Jk1ZsIY06PpV6Nwq9EHHeg0vVSqJSTJwhhdmp4n7rrUvUjFB4VVjiGkxjyoxLdLTaJuxDIohIfFHNcyNObAkTJgSuhQe7SYPW60QmNmdlI4zGXYrtqJVIhtV8mQqnag9SoYmbdTPuxm34shElUT8Vkjc8cCZOfdDJbs6CIqlIFe9F4tDruBPrOcmQXBMJnP0N3XQ49BTbdGzlNCXO/XMVJ3MdqwMtI0kamZSJaMDBT1lDoBwdWHKanDMKzBENTg8zqweM3M7p9GkpkWoSi72WlUIzMLyIKdd9SMM20Qzsw0z/hI1XV4R4RrMS+9GmPm4AAeEZRjXJwhEwP9TrROOcV6Hkm+PkWPTYPKZULlMWCLm9CHtISKJkIFPbUVPy/dTrN8PcziuQBPn/AwOGOl16ZAaZfji1jxuYVwv5lKU6Scr+SepBUo+Ml1ovhzVuxxI65MH8Gigcaqm1ffT7PyZoyFc/20TvkEyxCWoB7Zzh1093Sj16sw2/po7p0TPcxlGZgysf9ygtlTURovhDi7kebF2wmOXgtSPGoj1TARKxvF+v1ceTfLxVs5YhNOlCoFW7ZvQyMCtZqUzFWnkDTaZZZuJFh7ME3n9TTDDS/tywMcvxGhdtpD5bibyISOgXEde4TgG5sF5lp++mTdGJQyNKoevE4zFquSckPUptWusnhxiGsPS6z9scjJmyn2nI8wu+yndTpI86SfzvkBKkdd1E44OHsjSS5nYVfZQnzCRkCwi/S7sbh0ojai2MW5sohey9r9CVbfTXL9YZ6DVyPsPu8jf8TM1CGHSNnI7DE3C2f8XN/McePuFCvXMqSaHnz9FoKiNna3jub+CpLm4TrRXJRXNuv88rdjnLk9zKGrYTqvhVhej1I6ZmdoxsDQtJHTawn+/E2Fm/dLrH8wz1jLSyBkJxLyYLWq2dsWoWxsvsPpy2e59Lt5Lmzu4tJHY7zwXorFl8K0zgaYPGwXD21Mtl0cOT/I3cezfPhpiTt/a5MVLH1+G+GgC5ejj92LQvDbH/7Nxr27vPngWU5uxHldrN65MsTJ9RRzv/BTPu5hbI+dUE5PpmLno780+cc/93L/qwrzSxGxsuNJsT2iiwsH6kh++O+PfPavx/zm41XBb4q3HpU48asY86sRCgf8gmE/6ZqDbNPJ/nNh7j1q8sW3B/j6+w4XLk0SHvISj/oJh5w805kXgv/5kb9/94h7j9e59XmVl/+QYuVWktG2k1jDQnjGSHRGz+7n/Dy/EeHmgyy//2uRL79ucGIphs2jZ8BvxfZ/hotVJPcfPmD9/fd4Z3OdO1+e4oPHK9z8eJnlqwsculDjmdUqK2st3r6zxK8/7PCnr5b57PtVHn6ywtKzLarNCgf2NZivlbn4yvP8D+1INATwiQWWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"이런식으로 이미지가 돌아가서 나온다\"\n        title=\"이런식으로 이미지가 돌아가서 나온다\"\n        src=\"/static/625719c62fa92f2a941b08f9a8efa550/b9e4f/javascript-memo-exif-2.png\"\n        srcset=\"/static/625719c62fa92f2a941b08f9a8efa550/cf440/javascript-memo-exif-2.png 148w,\n/static/625719c62fa92f2a941b08f9a8efa550/d2d38/javascript-memo-exif-2.png 295w,\n/static/625719c62fa92f2a941b08f9a8efa550/b9e4f/javascript-memo-exif-2.png 590w,\n/static/625719c62fa92f2a941b08f9a8efa550/e198c/javascript-memo-exif-2.png 818w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">이런식으로 이미지가 돌아가서 나온다</figcaption>\n  </figure></p>\n<p>사실 좀 귀찮기도 하고 어떻게 고칠지 막막하기도 해서 그냥 냅두고 싶었지만 그러면 절대 안되기 때문에 우여곡절 어떻게든 방법을 찾아서 해결 했는데 그 과정을 공유해보고자 한다.</p>\n<h2>원인</h2>\n<p>카메라로 사진을 찍으면 메타데이터로 exif 값이 저장된다. 이 exif 는 디지털 카메라에서 이용되는 이미지 파일 포맷인데 여기에 orientation 이라고 사진의 방향 값이 저장되어 있다.</p>\n<p><img src=\"../images/frontend/javascript-memo-exif-4.gif\" alt=\"exif orientation\"></p>\n<p><a href=\"https://github.com/exif-js/exif-js\">exif-js</a> 오픈소스를 사용하면 exif 데이터를 읽어올 수 있길래 한번 써보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getExif</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> imageViewer <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"imageViewer\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n  reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">EXIF</span><span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> tags <span class=\"token operator\">=</span> <span class=\"token constant\">EXIF</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAllTags</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// metadata 출력</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>tags<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// 이미지 미리보기</span>\n      imageViewer<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundImage <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">url(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsDataURL</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3c61a08cff036eddd4fe273380f44a71/2e6ac/javascript-memo-exif-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.75703324808184%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAADP0lEQVQ4y5WT228UVRzH96/whRgupUBpO9ti2+2WsoBtoUuURRNFoCWFBOQBL8SYWhMlMcaHJpLw4IvxQR80vqstpgRtYuKDz/XSbsvu7GV257Y7s7C7c9n9eGaxtT6Ay0m+8z3zOzPffH+XExpPnEKKDjL0/Ajnrk9y6b048ddinJ4Z48TUcSInDxM9McxPy3cJlu/7PGmFpNEhntm7k11SB13RDkbPHGTsbA/9xw4gTXSxJ9JJZ88e7iz+0J7gwPERdhzoYLe0l9jLEicvhRm/IBE/P0jkxTA9R3uR+g/y41LbglF27N/NvsF9JK5FmJ6NMHmxV6R+lCPn+xmcCHNouJuFe9+3Jzg8GaMrJjH0Qj/RM728dSvGB1+McfWjI0QTfYQj3QxEe1lcWmhP8Nybp7h2K86VT8Z557NjXL4ZZWZuhPmvE8QTA+x8dhd9fftZunvnH0GPZrP5WIRev3ma2z+/xNxXE1ydH2Z67jnOvh3m48/HeXXmENHRbqS+ThaWvmsJNhr/4/DGhzf4cvldgevMf3OZudsXeP/Tiyz+Nsu392a58sYU01Ov8Muvy60f6vU6nufhuU6LXdf9NyYQymRk5EyevzZkVF1FVQvkcgqmaVAqmWiqhmEY4l3sNY1kMkk6lWY1lWd94z6yLJPPK5TLFpZlEao+rFJMahTXDMp6WYiUxEGZSsXGtm2RYmMrnaBGjlMXcKg5HnWxd4XToAxbDn2vgfq7hraSxVRMTKNKreZSsR0hWKdW9akK1OsNHAHPRfzYxHWaYi9YIDgL2BExIehjJIXQukIll8URjjc/egS/BccREOy6AR7FnW3xTQ41G01KaQt9VaekPMCyt/esydOulqC+aqCuaKjrJqWciW9bol7/rV27CAWPUqqMIcQqGYWq6JqVTGHLebygKaLQm6Lb+bEOgxqqf+gUV4qYskZOfkgu46DkRFNKNaHQINBo22EwFoFD836JctainMpRFzMXlML3m0+d9pZD7U8DPV3ALujYioKt6WJ8PB5UKgSzul38iSkHV0cXY6OsFlhf2xC3pkgmWyAtapkVvLa2SkbOUCyKpqlqC8HNCW6NaZYFCzNaELfRdYu/AdaOIrqnp54fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"확인해보면 orientation값이 6으로 되어있다.\"\n        title=\"확인해보면 orientation값이 6으로 되어있다.\"\n        src=\"/static/3c61a08cff036eddd4fe273380f44a71/b9e4f/javascript-memo-exif-3.png\"\n        srcset=\"/static/3c61a08cff036eddd4fe273380f44a71/cf440/javascript-memo-exif-3.png 148w,\n/static/3c61a08cff036eddd4fe273380f44a71/d2d38/javascript-memo-exif-3.png 295w,\n/static/3c61a08cff036eddd4fe273380f44a71/b9e4f/javascript-memo-exif-3.png 590w,\n/static/3c61a08cff036eddd4fe273380f44a71/f9b6a/javascript-memo-exif-3.png 885w,\n/static/3c61a08cff036eddd4fe273380f44a71/2d849/javascript-memo-exif-3.png 1180w,\n/static/3c61a08cff036eddd4fe273380f44a71/2e6ac/javascript-memo-exif-3.png 1564w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">확인해보면 orientation값이 6으로 되어있다.</figcaption>\n  </figure></p>\n<h2>해결 방법</h2>\n<p>대표님이 세가지 솔루션을 제시해주셨다.</p>\n<ol>\n<li>client 단에서 업로드시 orientation 값 기준으로 수정하여 서버에 업로드</li>\n<li>server 단에서 업로드 후 rotation 처리</li>\n<li>보여줄때 그때마다 rotation 처리해 주는 방식</li>\n</ol>\n<p>여기서 <a href=\"https://github.com/blueimp/JavaScript-Load-Image\">JavaScript-Load-Image</a> 오픈소스를 사용하면 첫번째 방법으로 해결이 될것 같아서 첫번째 방법으로 문제를 해결하기로 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">fixRotationOfFile</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>\n    image<span class=\"token punctuation\">,</span>\n    <span class=\"token parameter\">img</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> imageViewer <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"imageViewer\"</span><span class=\"token punctuation\">)</span>\n\n      imageViewer<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> maxWidth<span class=\"token punctuation\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> orientation<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8fde46600b719ca3dfea65658ca83088/7e0ae/javascript-memo-exif-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.78743961352657%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAABYlAAAWJQFJUiTwAAAHRElEQVRIxy2V6XNU1xHF569IxWHRNqPZNcubfXmzaEYzGrSikRAgIQFmkUBI7JtZhUAIjAkYgQ0xBlyFi8VOAEtIGDA7MQQqJhCDJAwhUAbCl1QqlaRS9UtLlQ9dr++re8/t07f7tCY3r4CJEycyfnwO48ZpWblyE3fu3OfcmXOc7x+k71w/gwOD9It/fvASZ78ZoG/wMoMXr9E3cJmBi1e5+N11WV/l0pWbaF6+ecO9kec8fvt3+r+/w/aDnWzbv4Hu/Z3sONBF5551zGydT2tHG4uWL6Zj2WLaVy6hbVUHS9YvZeHyDtrXLmdORwurt2xA84///Ju7L//GkfPXaFm3gVnrG5ixJsOkmQkWba6laXmGaLUXtdKFMWTH7LOicxnQe/WYgkb0LiN5YrnOAoqrE2iGX77iydt33Hv8mG9vXmPD/rWUzUyytLuR1vW1VDWVsGBNlrmrqolNDWEM2ymKOrHFXCjJIEa/BZ3bhClgo7S2Es2l27d5+uZn/gX8V+zwmSPUtKapfn8S2eYUamkArdVCcVUQtSaA3ldEvtNIvt1Arl2+Lgt5DhM5RVqiFWk0fVcv8/D5I37+51tuPvqRg6e+oKKxmvEGA9nWGB27M/gydixRs1B2yGEDWgHU2vQCKnSdZnKLDPyqMA9/Iopm8PpVrvzwDRcfneZ3fzjOrtMr2fz5XNYdreDg7el8dr+Rjt5SfNUeTCGnRKKnwGZkoklHjkVPnoBNEP+Xujy8MRXNrR+P0j+8lhN/aqHnfDmf3pjO/hsN/Pq7yRy6NZVtZ7O07ckwdXVa6FkpUISquZDx+gJhoRNgPTlmPb/Im4BvFPDe68Mc/L6ML39o5jc3pvHx5SxdZzMcul3LxxezTFkdZ/qGCGWtQZxpB4U+PeOE3jh9LuON2rEoJxh1vFc4kVBKKN9+dpTdFyaze6CSzSfK2Hepiq6v0nR9Xcqaz0uZ1RWh57flhGqckkMTSsqCyWdEpxSQa80XX4/ZLymw5pHKptCcvNLLtE0BFnyYlLxl+OBImo69Edr2qjR3qnSdSrO7r4xAdRFqrZ3IFIX4VBeJhtHyMWDy6zFITRr9WkomF6P55OsekvOLqF8RoX1XggU7VLaeTjO720PrNpX3u/zsOJsiMcNGfJqdUNbMlHYf05f5cKWNFEhBOxJ6Zm9QadtSg6b3yx5C00w0rY3TsMbPTIl23nY/DavdtHaptHSFmLHRRf0qN3VLPLRsC1Mx387iXcV4KwvRebXUtfrIzJB/H2XRHDixnZLZFsrnepm2wk9tu5tyOVDZIht2RqiaZ6ei1cG+vnL2nqugfqmTbJuTusWyr8WBM6WjfIZCcrqN+rZS6ZQ/HmTOZh/ZBX5SjQ7qF3tJNdkF2EX79ggl9RaidWa2HEuz81SKcI2OimYbiekWfBKhWm0iO98j+dSRrpNXvnCvl87jUVb1JlEnW5m/McKy7gQd3RGaVio0rvAyZ5PKsn1x1n4aJ91YRHyKldlrVVypQqHqorzZTaF7PFPmZdA8ePkZX1wvp+/3szg10MyFB7O485c5HOqrZudxqceBLPvPVDO308/crWFW7EkwdUmQ2oUBUSApo5gZq8eAp0QvrSqUf3p3jG8f1PNwZCnPXi/n6p+bOHO3ka/uNrFwSYRFK+McHpjK4u4k5a0e2jalaF4SJTPTS3qyV+rShrfMRlRKqqxZxOHJ88M8fNbMi3cruP9qHndGltF/q4NdJ7M0SG5s2lxRniChSmWsS8INCh6pSXupmWCVE0fGhqvCiq3UxKRRwCPHPqJnaymnT86js7eS2R8kmbUmSd0ylarZPhzGfMwWURhtPlqHFl+daGHGhD6qxVEmXRMzoPPpKAjkE8vKo3T1dFHkNZAqV4kkfARUJ+G4QjihEBOzGAt4b8I4JuROxF/sxJNxUBQ3Yg2LqKomCgNymVv625xDIBNBs3d3D2ERzUwyTDziJa56SMZETAMuYiEvfo8dbUEORhGCoF9aL+wmEFBwibAWBXwCqmAIijYqWmKVSTS7P+yWQxbKSqMk40FiAhgKOFAjLsIxD+Gwg5Dfhl9AIiV+3BEboeIQHglCcVpwKVYcikXKRku6RgA/PrCTSLHCpJooxZP8xFM+4hkPkVI37qQdZ9iCVwZTKOomKCmxhg24M0W4SowobjNeudznk8fxmciMAu49sAO/HFQrfPgld2qxl3BKohQ/KMPIq9pxhSwowkKRaPwypMLFDvwR+5gfCknkqluYuZnRIL28actGtMbcMUqBkFuoysiMewmqLnwyyQIxN0rURpHMEYvNgC1gwu7S45Qx4FFMBIR6JGiX/NqYXC2d0tnVidVuJplUicUCTMrEKSlRiccDJBNBonG/5MuJ4hL6ik0iteP1OgVgNLcOAbRTJY9RkghQNzpGX795zdDwE0ZGhsWG+OnpCE//b6P+yPAQw2M2zNDQkzEb/fdU9g4NPR5bv3r1V549e8qLF8/5H25FmpeaZwqBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"정방향으로 출력되는 이미지\"\n        title=\"정방향으로 출력되는 이미지\"\n        src=\"/static/8fde46600b719ca3dfea65658ca83088/b9e4f/javascript-memo-exif-4.png\"\n        srcset=\"/static/8fde46600b719ca3dfea65658ca83088/cf440/javascript-memo-exif-4.png 148w,\n/static/8fde46600b719ca3dfea65658ca83088/d2d38/javascript-memo-exif-4.png 295w,\n/static/8fde46600b719ca3dfea65658ca83088/b9e4f/javascript-memo-exif-4.png 590w,\n/static/8fde46600b719ca3dfea65658ca83088/7e0ae/javascript-memo-exif-4.png 828w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">정방향으로 출력되는 이미지</figcaption>\n  </figure>\n이렇게 하면 이미지가 정뱡향으로 출력된다!</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">const</span> fileType <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>type\n\n  <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>\n    file<span class=\"token punctuation\">,</span>\n    <span class=\"token parameter\">img</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">//</span>\n      img<span class=\"token punctuation\">.</span><span class=\"token function\">toBlob</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">blob</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> createdFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>blob<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// 이미지 업로드 실행은 여기서</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> fileType<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> orientation<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위의 코드와 같은 식으로 정방향으로 출력된 blob 이미지를 file 로 바꾸어 이미지를 업로드 하는 식으로 해결했다.</p>\n<h2>마무리</h2>\n<p>AWS S3 및 몇몇 서비스에서는 원본을 그대로 두고 이미지가 출력될 때마다 rotation 처리를 해주는 방식을 사용한 것 같던데 나중에 기회가 된다면 이미지가 출력될 때마다 rotation 처리를 해주는 방식 으로도 한번 해결해보고 싶다.</p>","frontmatter":{"title":"javascript로 사진 똑바로 만들기","date":"July 11, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2018-07-03-javascript-issue-ex-if/"}}}