{"componentChunkName":"component---src-templates-blog-template-tsx","path":"/front-end/typescript/react-test","webpackCompilationHash":"69d7a04769fb54056542","result":{"data":{"markdownRemark":{"id":"70a6dfea-1c83-52ca-9823-6144d9d062fc","html":"<p>개인 프로젝트를 작업 하고 있던 도중 테스트 환경을 도입해보고 싶어서 열심히 끄적이다가 기록을 남기기로 했다.\nTypeScript로 생성된 React 프로젝트에 테스트 환경 을 구축 해보고 테스트 까지 한번 해보자.</p>\n<p>해당 프로젝트는 create-react-app 으로 생성되었다.</p>\n<h2>테스트 환경 설정</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add --dev jest @types/jest\nyarn add --dev enzyme enzyme-adapter-react-16\nyarn add --dev @types/enzyme @types/enzyme-adapter-react-16</code></pre></div>\n<p>먼저 테스트에 필요한 모듈들을 설치해주자. TypeScript 환경이기 때문에 각 모듈들의 @types도 설치해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add --dev enzyme-to-json @types/enzyme-to-json</code></pre></div>\n<p>스냅샷의 가독성을 위해 enzyme-to-json 모듈도 설치하였다.</p>\n<h3>setupTest.ts</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Enzyme <span class=\"token keyword\">from</span> <span class=\"token string\">\"enzyme\"</span>\n<span class=\"token keyword\">import</span> ReactSixteenAdapter <span class=\"token keyword\">from</span> <span class=\"token string\">\"enzyme-adapter-react-16\"</span>\n\nEnzyme<span class=\"token punctuation\">.</span><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> adapter<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReactSixteenAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>CRA로 만든 프로젝트라면 위의 소스 파일 처럼 테스트 설정을 해줘야 한다.\n테스트 파일 작성 중 계속 오류가 발생하길래 리서치를 하던 도중 <a href=\"https://github.com/Microsoft/TypeScript-React-Starter/issues/76#issuecomment-340544510\">여기에서</a> 제시했던 대로 파일을 작성하니 정상 작동 되었다.</p>\n<h3>package.json</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ... 생략</span>\n  <span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ... 생략</span>\n    <span class=\"token property\">\"setupTestFrameworkScriptFile\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;rootDir>/test/setupTest.ts\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"snapshotSerializers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"enzyme-to-json/serializer\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\">// ... 생략</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ... 생략</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>package.json 파일에 위에처럼 enzyme, enzyme-to-json을 위한 설정만 추가해주면 설정은 끝난다.</p>\n<h2>컴포넌트 작성</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> classNames <span class=\"token keyword\">from</span> <span class=\"token string\">\"classnames\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Portal <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-minimalist-portal\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactCSSTransitionGroup <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-addons-css-transition-group\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./Modal.scss\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">ModalProps</span> <span class=\"token punctuation\">{</span>\n  backdropClassName<span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n  children<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>ReactNode<span class=\"token punctuation\">;</span>\n  modalClassName<span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n  isOpen<span class=\"token punctuation\">:</span> boolean<span class=\"token punctuation\">;</span>\n  onClose<span class=\"token punctuation\">:</span> any<span class=\"token punctuation\">;</span>\n  size<span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">ModalStates</span> <span class=\"token punctuation\">{</span>\n  isOpen<span class=\"token punctuation\">:</span> boolean<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Modal</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span><span class=\"token operator\">&lt;</span>ModalProps<span class=\"token punctuation\">,</span> ModalStates<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    backdropClassName<span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    children<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    modalClassName<span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    isOpen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">onClose</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    size<span class=\"token punctuation\">:</span> <span class=\"token string\">\"sm\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  handleIgnoreEvent<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">any</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  handleClose<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">any</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">onClose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">JSX</span><span class=\"token punctuation\">.</span>Element <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      backdropClassName<span class=\"token punctuation\">,</span>\n      children<span class=\"token punctuation\">,</span>\n      isOpen<span class=\"token punctuation\">,</span>\n      modalClassName<span class=\"token punctuation\">,</span>\n      onClose<span class=\"token punctuation\">,</span>\n      size\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isOpen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Portal<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div\n          className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">classNames</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string\">\"modal-backdrop\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span> open<span class=\"token punctuation\">:</span> isOpen <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            backdropClassName\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onClose<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>ReactCSSTransitionGroup\n            transitionName<span class=\"token operator\">=</span><span class=\"token string\">\"example\"</span>\n            transitionAppear<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span>\n            transitionAppearTimeout<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">300</span><span class=\"token punctuation\">}</span>\n            transitionLeave<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span>\n            transitionEnterTimeout<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">300</span><span class=\"token punctuation\">}</span>\n            transitionLeaveTimeout<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">500</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>div\n              className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">classNames</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"modal\"</span><span class=\"token punctuation\">,</span> modalClassName<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n              onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleIgnoreEvent<span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>button type<span class=\"token operator\">=</span><span class=\"token string\">\"button\"</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onClose<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n                닫기\n              <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n              <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ReactCSSTransitionGroup<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Portal<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>간단하게 모달 컴포넌트를 작성했다. 이 모달 컴포넌트를 테스트 해 볼 것이다.</p>\n<h2>테스트코드 작성</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Enzyme <span class=\"token keyword\">from</span> <span class=\"token string\">\"enzyme\"</span>\n<span class=\"token keyword\">import</span> Modal <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Modal\"</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;Modal />\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> component <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">let</span> isOpen <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\n  <span class=\"token comment\">// 모달 컴포넌트 랜더링</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal Render...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component <span class=\"token operator\">=</span> Enzyme<span class=\"token punctuation\">.</span><span class=\"token function\">shallow</span><span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Modal\n        backdropClassName<span class=\"token operator\">=</span><span class=\"token string\">\"test-backdrop\"</span>\n        modalClassName<span class=\"token operator\">=</span><span class=\"token string\">\"test-modal\"</span>\n        isOpen<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>isOpen<span class=\"token punctuation\">}</span>\n        size<span class=\"token operator\">=</span><span class=\"token string\">\"sm\"</span>\n        onClose<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          isOpen <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>Modal Test<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Modal<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>맨 먼저 스냅샷 테스트코드를 작성했다.</p>\n<ul>\n<li>describe는 테스트 무리를 가지고 있는 함수이다. 두개의 parameter를 받는데 첫번째는 테스트에 붙이는 의미있는 이름이고 두번째는 여러개의 테스트를 포함한 함수이다. descirbe는 중첩해서 사용할 수도 있다.</li>\n<li>it은 테스트 자체가 되는 함수 이며 두개의 parameter를 받는다. 첫번째는 test의 이름이고 두번째는 테스트의 본문을 유지한다.</li>\n<li>expect는 여러 가지 유효성 검사기에 대한 액세스를 제공하여 여러 가지를 검증한다.</li>\n<li>shallow는 Enzyme에서 제공하는 rendering API 이다. rednering API에는 mount, render가 더 있는데 각각 작동하는 방식이 다르므로 <a href=\"https://medium.com/@Yohanna/difference-between-enzymes-rendering-methods-f82108f49084\">상황에 맞춰서 알맞은 것</a>을 골라서 사용하면 된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;Modal />\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ... 생략</span>\n\n  <span class=\"token comment\">// 모달이 닫겨 있을 때</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal close...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component<span class=\"token punctuation\">.</span><span class=\"token function\">setProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> isOpen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal-backdrop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// 모달이 열려 있을 때</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal open...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component<span class=\"token punctuation\">.</span><span class=\"token function\">setProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> isOpen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal-backdrop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// ... 생략</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>isOpen props를 받아서 모달의 출력 여부를 판단하므로 isOpen의 값에 따라 모달이 존재 하는지 안하는지 확인하는 테스트 코드를 작성 했다.\nisOpen이 false 일 때는 컴포넌트의 render 함수가 null을 리턴하므로 false 값이 나와야 하고 isOpen이 true 일 때는 모달이 정상적으로 출력되므로 true 값이 나와야 한다.</p>\n<ul>\n<li>toBe 메소드는 값이 예상한 값인지 확인한다.</li>\n<li>find 메소드는 인자로 받은 selector을 통하여 컴포넌트 안에서 특정 DOM을 찾을 수 있게 해준다.</li>\n<li>exists 메소드는 찾는 노드나 selector의 존재 유무를 판단해준다.</li>\n<li>setProps 메소드로 root 컴포넌트의 props를 설정하고 재랜더링 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;Modal />\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ... 생략</span>\n\n  <span class=\"token comment\">// 모달이 열려 있을 때</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal open...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component<span class=\"token punctuation\">.</span><span class=\"token function\">setProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> isOpen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal-backdrop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// 모달 안을 클릭 했을 때</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal click...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">simulate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> lastChild <span class=\"token operator\">=</span> component\n      <span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">last</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>lastChild<span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    lastChild<span class=\"token punctuation\">.</span><span class=\"token function\">simulate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// 모달 닫기 버튼을 눌러 닫을 때</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modal is closing...\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">simulate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".modal-backdrop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이벤트가 발생했을 때 컴포넌트가 원하는 대로 작동하는지 확인하는 테스트 코드를 작성했다.\n모달이 출력되었을 때 모달 및 모달 안의 자식 DOM들을 클릭했을 때도 모달이 닫기면 안되기 때문에 모달 안의 DOM을 눌렀을 떄 모달이 닫기는지 안닫기는지 테스트 하고 있다.\n모달 안에서 닫기 버튼을 눌렀을 때는 모달이 닫겨야 하므로 버튼 테스트도 작성했다.\n모달 안의 DOM을 클릭 할 때 stopPropagation 이벤트가 발생하므로 가짜 함수를 추가 하였다.(<a href=\"https://github.com/airbnb/enzyme/issues/323\">참조</a>)</p>\n<ul>\n<li>debug 메소드는 디버깅 목적으로 HTML과 유사한 wrapper 문자열을 반환한다.</li>\n<li>simulate 메소드는 이벤트를 시뮬레이션 한다. 첫번째 파라미터는 시뮬레이터 할 이벤트 이름을 넣고 두번째 파라미터에는 이벤트에 전달 되는 모의 이벤트 객체가 들어간다.</li>\n</ul>\n<h2>테스트</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn run test</code></pre></div>\n<p>위의 명령어로 테스트를 실행할 수 있다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 187px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5bd552831851635ebd535602a375a452/548b5/typescript-react-test-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.598930481283425%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABIUlEQVQY02WRXU7CQBSFuwR9MyrQVkD7N50plvIjWCggAUVBawwh8c0duA+34Eo/Z9AYEx9u5uTOvd+cnLHqnkTKjKNJQbXcYDciamc+oVAEkSSMFJHWSrWIZbLvV10fux7gNMJ/ZV2IS3rpgMNdiff5wYUfI4RksxxzP895LW9YToesFyPKu4LV/BoRK9xm+Av9C7eMm1P7HNf1cBwPO+lqqNAuAyo/Tqp6xugT29uf5lFXL5sZU2bG9I229uRmhKOXalHKwds7lTBluxrz8jDh6XbMdj2l18l41Pp5VZAPusxGV8yLAf1uxmIyZLeZMc37WLaxbKAG6CuO8wW1oEUQCKTOTaoElbTwQ0k7TUm0DnW2Jl8Rf2dq7jpZW/9Fwhe67Z3JFfBqiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"스냅샷 생성\"\n        title=\"스냅샷 생성\"\n        src=\"/static/5bd552831851635ebd535602a375a452/548b5/typescript-react-test-1.png\"\n        srcset=\"/static/5bd552831851635ebd535602a375a452/cf440/typescript-react-test-1.png 148w,\n/static/5bd552831851635ebd535602a375a452/548b5/typescript-react-test-1.png 187w\"\n        sizes=\"(max-width: 187px) 100vw, 187px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">스냅샷 생성</figcaption>\n  </figure>\n테스트를 실행하면 스냅샷 폴더가 생긴다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Jest Snapshot v1, https://goo.gl/fbAQLP</span>\n\nexports<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;Modal /> Modal Render... 1</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n&lt;Portal>\n  &lt;div\n    className=\"modal-backdrop open test-backdrop\"\n    onClick={[Function]}\n  >\n    &lt;CSSTransitionGroup\n      transitionAppear={true}\n      transitionAppearTimeout={300}\n      transitionEnter={true}\n      transitionEnterTimeout={300}\n      transitionLeave={true}\n      transitionLeaveTimeout={500}\n      transitionName=\"example\"\n    >\n      &lt;div\n        className=\"modal test-modal sm\"\n        onClick={[Function]}\n      >\n        &lt;button\n          onClick={[Function]}\n          type=\"button\"\n        >\n          닫기\n        &lt;/button>\n        &lt;div>\n          Modal Test\n        &lt;/div>\n      &lt;/div>\n    &lt;/CSSTransitionGroup>\n  &lt;/div>\n&lt;/Portal>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>이런식으로 스냅샷이 생성된다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/011abd617c9fd22b909594a7c6d10253/58aad/typescript-react-test-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.16290726817043%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7klEQVQ4y41TyXbaUAzlS7JJYwzGDDYe8IAHbIPtkHKanA6LdtE/6Zff6oqaEtL2dCFk9PR07qA3uvt+xN2PbzA/9gi9DEGyQ7ytsUkq+FEBb5MjyffYpBWqwxOKukdaHLCViKRvtggwtlyYs7XGaOwGCPct8vaINGtkQKGDHD+FJc3M/D9bhrBXjA3mEsysTWzv9UBz6uLeXCCvOnTHZ4RxiX13QiB54UZo2pOi4yVj6ryJYdiQR/x5sF1sdy3a/oNQ3aE+vMfSjeGFuQ4nsofJ6oLiX6ED763VZaAvlBOhTlQcHqW1oiZt9t6iMySu0etAajV3NnC8VGjGqhG/lbYTaW0dZliu47OGrElYC191ZLZV11BMkenq4P5J0fEijeBA1iMJOu36W3WezhIxN4GShMKC/UFU6t3RwL1sHlFUvR6uZYBpr5XOQO1Ppoyvzi+UKTYLwaCTJRLMPJhjMcE8N7OHzf9lCinFv0xIsz0WfgIjSWA2BSZljrloRFqkd71vQ9zWRtz+0/MXZOKyL5emXgTjsYLxuYP10sHztvpCeP43VK8Wmzv38ukrsrLV3TNEu1VTw+4bjNMElrwEN8jUJFJ/Zy4l/5bizWKX9dkMukgduXu7Smp5q+jyXaeO0kFmvpyUb1v6uK+3CH8CGEKnB10fTrQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"테스트 성공\"\n        title=\"테스트 성공\"\n        src=\"/static/011abd617c9fd22b909594a7c6d10253/b9e4f/typescript-react-test-2.png\"\n        srcset=\"/static/011abd617c9fd22b909594a7c6d10253/cf440/typescript-react-test-2.png 148w,\n/static/011abd617c9fd22b909594a7c6d10253/d2d38/typescript-react-test-2.png 295w,\n/static/011abd617c9fd22b909594a7c6d10253/b9e4f/typescript-react-test-2.png 590w,\n/static/011abd617c9fd22b909594a7c6d10253/58aad/typescript-react-test-2.png 798w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">테스트 성공</figcaption>\n  </figure>\n테스트에 성공하면 위의 스샷 처럼 성공 메시지들이 출력된다.\ndebug로 child elements가 제대로 출력되는지 console.log를 찍었기 떄문에 console.log 결과물이 같이 출력되었다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0dde27d725aaf2037be0893d214dda3/f33be/typescript-react-test-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.30935251798561%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVQ4y4VTWZKbMBT0YcYCzC5AIBCb8ZJJpVI5Qf5y/yN0+glnMjVxTT5au1r9Xj8dfuY1frUOTTejsQsMoZuR8wVtf8a43NG5Dd2woeaZMKkRxJXvn+GQpg3m5YZl+8pLZ7REWlr00xV5NfhDp8x4RDz7X8KXk0ZpZ9xff2A+v2IgkbErztdvCLjnQYL3+Iz0oHhBtxPW+3eYfkU3XtCRtOG4IhJtP1X0ce+QpzWmrMGUG8Rc6IsWI6FjjU1CZ6hHPqqe4JnaQ8SmqR1M4zyJ5WZXD+hEXWcREylV1u2MipFIXsU8babnCgM2LV10yxdUZkRUM/n5bsIxq6GoXsx4b0yct378T/hCKAMpBymNksrKwvgL3l1eVkyJSiucOI9TkhIqoTmpqJPQqz18IiQOIjn2r+656tyFTt9YPivsdEHiJsS9Q25Zm/MG7RaofkBqHYrK+sfTskOsewSFpUISZlxMis6HI7UoOerHq1fdPopd9T2Oo4NyrM1xRMn0WD4uH6Ln49V4Q2i3XaHkQwi1GUiq8RKVOH5AGDGk8IFod/n9vvJnyr+EGUskKcybAaH8Cukf44D9G2TPw/hU/flBu8sPwoplIebULA0JR2mG156JFUHFuVn9WNaCeoKqZ5yayacoY/5EsRD+BiGwnAu6tl2vAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"테스트 실패\"\n        title=\"테스트 실패\"\n        src=\"/static/b0dde27d725aaf2037be0893d214dda3/b9e4f/typescript-react-test-3.png\"\n        srcset=\"/static/b0dde27d725aaf2037be0893d214dda3/cf440/typescript-react-test-3.png 148w,\n/static/b0dde27d725aaf2037be0893d214dda3/d2d38/typescript-react-test-3.png 295w,\n/static/b0dde27d725aaf2037be0893d214dda3/b9e4f/typescript-react-test-3.png 590w,\n/static/b0dde27d725aaf2037be0893d214dda3/f9b6a/typescript-react-test-3.png 885w,\n/static/b0dde27d725aaf2037be0893d214dda3/f33be/typescript-react-test-3.png 1112w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">테스트 실패</figcaption>\n  </figure>\n테스트에 실패하면 실패한 테스트 코드 위치와 원하는 테스트 값, 실제로 나온 테스트 결과값을 보여준다.</p>\n<h2>마무리</h2>\n<p>테스트코드를 작성해본건 이번이 처음이라 틀린 부분이 있을 수도 있다 ㅠ. 이번 포스팅을 기회로 테스트 습관을 들이도록 노력해봐야겠다.</p>\n<p>수정해야 할 부분이나 보완되어야 할 부분이 있으면 언제든 피드백 부탁드립니다.</p>\n<p><a href=\"https://github.com/partyKyoung/wolfOnAir-front/tree/master/src/components/ui/Modal\">소스 코드 전체 보기</a></p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://rjzaworski.com/2018/03/testing-with-typescript-react-and-enzyme\">Testing with TypeScript, Enzyme, and React</a></li>\n<li><a href=\"https://airbnb.io/enzyme/\">Enzyme</a></li>\n<li><a href=\"https://medium.com/@sangboaklee/react-%ED%85%8C%EC%8A%A4%ED%8C%85-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0-1c3719cee5af\">[React] 테스팅 코드 작성하기</a></li>\n</ul>","frontmatter":{"date":"2019년 02월 14일","description":"테스트 환경 구축 및 코드 작성 과정을 기록하였습니다.","path":"/front-end/typescript/react-test","title":"TypeScript로 생성한 React 프로젝트에서 테스트 환경 구축 및 테스트 실행하기"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}